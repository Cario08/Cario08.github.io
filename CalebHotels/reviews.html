<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caleb Hotels - Reviews</title>
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <header>
        <div class="logo">
            <img src="../Images/Logo.png" alt="Caleb Hotels Logo">
        </div>
        <nav>
            <ul>
                <li><a href="../index.html">Home</a></li>
                <li><a href="CalebHotels.html">Caleb Hotels</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="review-form">
            <h2>Leave a Review</h2>
            <form id="reviewForm">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required>

                <label>Rating:</label>
                <div class="star-rating">
                    <input type="radio" id="star5" name="rating" value="5">
                    <label for="star5">★</label>
                    <input type="radio" id="star4" name="rating" value="4">
                    <label for="star4">★</label>
                    <input type="radio" id="star3" name="rating" value="3">
                    <label for="star3">★</label>
                    <input type="radio" id="star2" name="rating" value="2">
                    <label for="star2">★</label>
                    <input type="radio" id="star1" name="rating" value="1">
                    <label for="star1">★</label>
                </div>

                <label for="review">Review:</label>
                <textarea id="review" name="review" required></textarea>

                <button type="submit">Submit Review</button>
            </form>
        </section>

        <section class="previous-reviews">
            <h2>Previous Reviews</h2>
            <div id="reviewsList">
                <!-- Reviews will be dynamically inserted here -->
            </div>
        </section>
    </main>

    <footer>
        <br>
        <p>Created by Caleb D.</p>
        <p class="hidden-text">E-1218</p>
    </footer>

    <!-- Add Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.1.0/firebase-database.js"></script>

    <script>
        // Firebase configuration
        <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caleb Hotels - Reviews</title>
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <header>
        <div class="logo">
            <img src="../Images/Logo.png" alt="Caleb Hotels Logo">
        </div>
        <nav>
            <ul>
                <li><a href="../index.html">Home</a></li>
                <li><a href="CalebHotels.html">Caleb Hotels</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="review-form">
            <h2>Leave a Review</h2>
            <form id="reviewForm">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required>

                <label>Rating:</label>
                <div class="star-rating">
                    <input type="radio" id="star5" name="rating" value="5">
                    <label for="star5">★</label>
                    <input type="radio" id="star4" name="rating" value="4">
                    <label for="star4">★</label>
                    <input type="radio" id="star3" name="rating" value="3">
                    <label for="star3">★</label>
                    <input type="radio" id="star2" name="rating" value="2">
                    <label for="star2">★</label>
                    <input type="radio" id="star1" name="rating" value="1">
                    <label for="star1">★</label>
                </div>

                <label for="review">Review:</label>
                <textarea id="review" name="review" required></textarea>

                <button type="submit">Submit Review</button>
            </form>
        </section>

        <section class="previous-reviews">
            <h2>Previous Reviews</h2>
            <div id="reviewsList">
                <!-- Reviews will be dynamically inserted here -->
            </div>
        </section>
    </main>

    <footer>
        <br>
        <p>Created by Caleb D.</p>
        <p class="hidden-text">E-1218</p>
    </footer>

    <!-- Add Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/11.3.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.3.0/firebase-database.js"></script>

    <script>
        // Firebase configuration
        const firebaseConfig = {
  apiKey: "AIzaSyAAAm41IAaAphPY44yBYgOXyCLwLUMuM0o",
  authDomain: "cariovu.firebaseapp.com",
  projectId: "cariovu",
  storageBucket: "cariovu.firebasestorage.app",
  messagingSenderId: "321829931234",
  appId: "1:321829931234:web:54dd0e8fb728ef783cb6bb"
};

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Function to save review to Firebase
        async function saveReviewToFirebase(reviewData) {
            try {
                const reviewsRef = database.ref('reviews');
                await reviewsRef.push(reviewData);
                console.log('Review saved to Firebase');
            } catch (error) {
                console.error('Error saving review:', error);
            }
        }

        // Function to display reviews
        function displayReview(reviewData) {
            const reviewsList = document.getElementById('reviewsList');

            const reviewItem = document.createElement('div');
            reviewItem.classList.add('review-item');

            reviewItem.innerHTML = `
                <h3>${reviewData.name}</h3>
                <div class="stars">${'★'.repeat(reviewData.rating)}</div>
                <p>${reviewData.review}</p>
                <div class="date">${reviewData.date}</div>
            `;

            reviewsList.prepend(reviewItem); // Add new review to the top
        }

        // Function to fetch and display existing reviews
        function fetchAndDisplayReviews() {
            const reviewsRef = database.ref('reviews');
            reviewsRef.on('value', (snapshot) => {
                const reviewsList = document.getElementById('reviewsList');
                reviewsList.innerHTML = ''; // Clear existing reviews

                snapshot.forEach((childSnapshot) => {
                    const review = childSnapshot.val();
                    displayReview(review);
                });
            });
        }

        // Handle form submission
        document.getElementById('reviewForm').addEventListener('submit', function (event) {
            event.preventDefault();

            // Get form data
            const name = document.getElementById('name').value;
            const rating = document.querySelector('input[name="rating"]:checked').value;
            const review = document.getElementById('review').value;
            const date = new Date().toLocaleDateString();

            // Create review object
            const reviewData = {
                name,
                rating: parseInt(rating), // Ensure rating is a number
                review,
                date
            };

            // Save to Firebase
            saveReviewToFirebase(reviewData);

            // Display the review on the page
            displayReview(reviewData);

            // Clear the form
            document.getElementById('reviewForm').reset();
        });

        // Fetch and display existing reviews when the page loads
        fetchAndDisplayReviews();
    </script>
</body>
</html>