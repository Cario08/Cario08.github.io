<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Complaints and Suggestions</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f9f9f9;
    }
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #333;
      color: #fff;
      padding: 10px 20px;
      box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    header img {
      height: 70px;
    }
    header .title {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .container {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px auto;
      width: 90%;
      max-width: 1200px;
    }
    .main-section, .sidebar {
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 8px;
      box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
      padding: 20px;
    }
    .main-section {
      flex: 3;
    }
    .sidebar {
      flex: 1;
      max-width: 300px;
    }
    .sidebar h2 {
      font-size: 1.5rem;
    }
    .review-form input, .review-form textarea {
      width: calc(100% - 20px);
      margin-bottom: 10px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
    }
    .review-form button {
      width: 100%;
      background: #007bff;
      color: #fff;
      padding: 15px;
      font-size: 16px;
      font-weight: bold;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .review-form button:hover {
      background: #0056b3;
    }
    #reviews {
      margin-top: 20px;
    }
    .review {
      background: #fff;
      margin-bottom: 15px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      position: relative;
    }
    .review h3 {
      margin: 0 0 5px;
    }
    .dots {
      position: absolute;
      top: 10px;
      right: 10px;
      cursor: pointer;
      font-size: 24px;
      padding: 8px;
    }
    .dots:hover {
      background-color: #f0f0f0;
      border-radius: 4px;
    }
    .dropdown-menu {
      position: absolute;
      top: 35px;
      right: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      background: #fff;
      display: none;
      z-index: 10;
    }
    .dropdown-menu button {
      display: block;
      width: 100%;
      border: none;
      background: none;
      padding: 10px;
      text-align: left;
      cursor: pointer;
    }
    .dropdown-menu button:hover {
      background: #f0f0f0;
    }
    a {
      text-decoration: none;
      color: #333;
    }
    a:hover {
      color: #555;
    }
    .sidebar a {
    display: block;
    margin-bottom: 10px;
    padding: 15px;
    text-align: center;
    font-weight: bold;
    border-radius: 30px;
    cursor: pointer;
    transition: background 0.3s, color 0.3s;
  }
  .sidebar a#back {
    background: #007bff;
    color: #fff;
  }
  .sidebar a#reviews-button {
    background: #007bff;
    color: #fff;
  }
  .sidebar a#download-reviews {
    background: #28a745;
    color: #fff;
  }
  .sidebar a#upload-reviews {
    background: #007bff;
    color: #fff;
  }
  .sidebar a#back:hover,
  .sidebar a#reviews-button:hover,
  .sidebar a#upload-reviews:hover {
    background: #0056b3;
  }
  .sidebar a#download-reviews:hover {
    background: #1e7e34;
  }
    .sidebar .developer-tools {
      margin-top: 20px;
    }
    .button-container {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }
    .complaint-btn {
      background: red;
      color: white;
      flex: 1;
      padding: 15px;
      font-weight: bold;
      border-radius: 30px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .complaint-btn:hover {
      background: darkred;
    }
    .suggestion-btn {
      background: yellow;
      color: black;
      flex: 1;
      padding: 15px;
      font-weight: bold;
      border-radius: 30px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .suggestion-btn:hover {
      background: gold;
    }
    .tag {
      display: inline-block;
      padding: 5px 10px;
      border-radius: 20px;
      font-weight: bold;
      color: white;
    }
    .complaint-tag {
      background-color: red;
    }
    .suggestion-tag {
      background-color: yellow;
      color: black;
    }
    .sidebar a:hover {
      background: #0056b3;
      color: white;
    }
  </style>
</head>
<body>
  <header>
    <div class="title">
      <img src="logo.png" alt="Logo">
      <h1>Complaints and Suggestions</h1>
    </div>
  </header>
  <div class="container">
    <div class="main-section">
      <form id="complaint-form" class="review-form">
        <input id="name" type="text" placeholder="Your Name" required>
        <textarea id="item" placeholder="Your Complaint or Suggestion" required></textarea>
        
        <div class="button-container">
          <button type="button" class="complaint-btn">Complaint</button>
          <button type="button" class="suggestion-btn">Suggestion</button>
        </div>
        
        <button type="submit">Submit Item</button>
      </form>
      <div id="reviews"></div>
    </div>
    <div class="sidebar">
      <h2>Links</h2>
      <a href="CalebHotels.html" id="back">Back</a>
      <a href="review.html" id="reviews-button">Reviews</a>

      <div class="developer-tools">
        <h2>Developer Tools</h2>
        <a href="#" id="download-reviews" onclick="downloadReviews()">Download Items</a>
        <a href="#" id="upload-reviews" onclick="uploadReviews()">Upload Items</a>
      </div>
    </div>
  </div>

  <script>
    const reviewsKey = 'complaintsSuggestions';
    const reviewsDiv = document.getElementById('reviews');
    const form = document.getElementById('complaint-form');
    const complaintBtns = document.querySelectorAll('.button-container button');
    const submitBtn = form.querySelector('button[type="submit"]');
    let selectedType = '';
    let openDropdown = null; // Track the currently open dropdown menu

    complaintBtns.forEach(button => {
      button.addEventListener('click', () => {
        selectedType = button.textContent;
        highlightButton(selectedType);
      });
    });

    function highlightButton(type) {
      complaintBtns.forEach(button => {
        button.style.opacity = button.textContent === type ? '1' : '0.6';
      });
    }

    function saveReview(name, type, text) {
      const reviews = JSON.parse(localStorage.getItem(reviewsKey)) || [];
      reviews.unshift({ name, type, text, date: new Date().toISOString() });
      localStorage.setItem(reviewsKey, JSON.stringify(reviews));
      displayReviews();
    }

    function displayReviews() {
      const reviews = JSON.parse(localStorage.getItem(reviewsKey)) || [];
      reviewsDiv.innerHTML = '';
      reviews.forEach((review, index) => {
        const reviewDiv = document.createElement('div');
        reviewDiv.className = 'review';
        const tagClass = review.type.toLowerCase() === 'complaint' ? 'complaint-tag' : 'suggestion-tag';
        reviewDiv.innerHTML = ` 
          <h3>${review.name}</h3>
          <span class="tag ${tagClass}">${review.type}</span>
          <p>${review.text}</p>
          <small>${new Date(review.date).toLocaleString()}</small>
          <div class="dots" onclick="toggleDropdown(${index})">â‹®</div>
          <div class="dropdown-menu" id="dropdown-${index}">
            <button onclick="editReview(${index})">Edit</button>
            <button onclick="deleteReview(${index})">Delete</button>
          </div>
        `;
        reviewsDiv.appendChild(reviewDiv);
      });
    }

    function toggleDropdown(index) {
      const menu = document.getElementById(`dropdown-${index}`);
      if (openDropdown === index) {
        // Close the dropdown if it's already open
        menu.style.display = 'none';
        openDropdown = null;
      } else {
        // Open the new dropdown
        if (openDropdown !== null) {
          document.getElementById(`dropdown-${openDropdown}`).style.display = 'none';
        }
        menu.style.display = 'block';
        openDropdown = index;
      }
    }

    function editReview(index) {
      const reviews = JSON.parse(localStorage.getItem(reviewsKey)) || [];
      const review = reviews[index];
      document.getElementById('name').value = review.name;
      document.getElementById('item').value = review.text;
      selectedType = review.type;
      highlightButton(selectedType);
      deleteReview(index);
    }

    function deleteReview(index) {
      const reviews = JSON.parse(localStorage.getItem(reviewsKey)) || [];
      reviews.splice(index, 1);
      localStorage.setItem(reviewsKey, JSON.stringify(reviews));
      displayReviews();
    }

    form.addEventListener('submit', e => {
      e.preventDefault();
      const name = document.getElementById('name').value;
      const text = document.getElementById('item').value;
      if (!selectedType) {
        alert('Please select a complaint or suggestion');
        return;
      }
      saveReview(name, selectedType, text);
      form.reset();
      selectedType = '';
      highlightButton('');
    });

    function downloadReviews() {
      const reviews = JSON.parse(localStorage.getItem(reviewsKey)) || [];
      const blob = new Blob([JSON.stringify(reviews, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'items.json';
      a.click();
      URL.revokeObjectURL(url);
    }

    function uploadReviews() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json';
      input.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = function(event) {
          try {
            const uploadedReviews = JSON.parse(event.target.result);
            if (Array.isArray(uploadedReviews)) {
              localStorage.setItem(reviewsKey, JSON.stringify(uploadedReviews));
              displayReviews();
            } else {
              alert('Invalid file format');
            }
          } catch (error) {
            alert('Error reading file');
          }
        };
        reader.readAsText(file);
      });
      input.click();
    }

    // Close any open dropdown when clicking outside
    document.addEventListener('click', (e) => {
      if (!e.target.classList.contains('dots')) {
        const openMenu = document.querySelector('.dropdown-menu[style="display: block;"]');
        if (openMenu) openMenu.style.display = 'none';
        openDropdown = null;
      }
    });

    displayReviews();
  </script>
</body>
</html>
